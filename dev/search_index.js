var documenterSearchIndex = {"docs":
[{"location":"references/#References","page":"References","title":"References","text":"F. Ederer. The relative survival rate: a statistical methodology. Natl. Cancer Inst. Monogr. 6, 101–121 (1961).\n\n\n\nF. Ederer and H. Heise. The effect of eliminating deaths from cancer in general survival rates, methodological notes 11. End Result Evaluation Section, National Cancer Institute (1959).\n\n\n\nT. Hakulinen. On long-term relative survival rates. Journal of Chronic Diseases 30, 431–443 (1977).\n\n\n\nM. Pohar Perme, J. Stare and J. Estève. On Estimation in Relative Survival. Biometrics 68, 113–120 (2011).\n\n\n\nN. Grafféo, F. Castell, A. Belot and R. Giorgi. A Log-Rank-Type Test to Compare Net Survival Distributions. Biometrics 72, 760–769 (2016).\n\n\n\nT. R. Fleming and D. P. Harrington. Counting Processes and Survival Analysis. Vol. 625 (John Wiley & Sons, 2013).\n\n\n\nP. K. Andersen, O. Borgan, R. D. Gill and N. Keiding. Statistical Models Based on Counting Processes. Springer Series in Statistics (Springer US, New York, NY, 1993).\n\n\n\nM. Pohar Perme and K. Pavlic. Nonparametric relative survival analysis with the R package relsurv. Journal of Statistical Software 87, 1–27 (2018).\n\n\n\nH. Charvat and A. Belot. Mexhaz: An R package for fitting flexible hazard-based regression models for overall and excess mortality with a random effect. Journal of Statistical Software 98, 1–36 (2021).\n\n\n\nK. A. Cronin and E. J. Feuer. Cumulative cause-specific mortality for cancer patients in the presence of other causes: a crude analogue of relative survival. Statistics in medicine 19, 1729–1740 (2000).\n\n\n\nO. Laverny, N. Grafféo and R. Giorgi. Non-parametric estimation of net survival under dependence between death causes (2025), arXiv:2502.09273 [math.ST].\n\n\n\nV. Zadnik, M. P. Žakelj and M. Krajc. Cancer burden in Slovenia in comparison with the burden in other European countries. Slovenian Medical Journal 81 (2012).\n\n\n\nV. Zadnik, T. Žagar and M. P. Žakelj. Cancer patients’ survival: standard calculation methods and some considerations regarding their interpretation. Slovenian Journal of Public Health 55, 144–151 (2016).\n\n\n\nR. Giorgi, M. Abrahamowicz, C. Quantin, P. Bolard, J. Esteve, J. Gouvernet and J. Faivre. A relative survival regression model using B-spline functions to model non-proportional hazards. Statistics in medicine 22, 2767–2784 (2003).\n\n\n\nA. Wolski, N. Grafféo, R. Giorgi and the CENSUR working survival group. A Permutation Test Based on the Restricted Mean Survival Time for Comparison of Net Survival Distributions in Non-Proportional Excess Hazard Settings. Statistical Methods in Medical Research 29, 1612–1623 (2020).\n\n\n\n\n\nT. Hakulinen and K. H. Abeywickrama. A computer program package for relative survival analysis. Computer programs in biomedicine 19, 197–207 (1985).\n\n\n\nT. Hakulinen and L. Tenkanen. Regression analysis of relative survival rates. Journal of the Royal Statistical Society Series C: Applied Statistics 36, 309–317 (1987).\n\n\n\n","category":"section"},{"location":"benches/#Benchmarking-results","page":"Benchmarking results","title":"Benchmarking results","text":"This page provides benchmark results of several standard net survival routines implemented in this package. Note that the runtime also depends on other packages, in particular on RateTables.jl. \n\nnote: Take numbers displayed here carefully\nAll the following benchmarks are run on github action contunous integration platform, which is a very slow computing engine. Thus, these numbers may not represent your local performance. A locally ran version of these benchmarks in availiable on the github readme, and the below code blocks can be used to check performance on your own hardware.","category":"section"},{"location":"benches/#Benchmarks-w.r.t.-relsurv","page":"Benchmarking results","title":"Benchmarks w.r.t. relsurv","text":"This first set of benchmark compares standard functionalities with their implementation in relsurv. Below numbers gives runtime mulitpliers w.r.t. R::relsurv, computed on github action CI.\n\nusing RateTables, NetSurvival, RCall, DataFrames\n\nfunction test_surv(r_method,::Type{E}, stratified) where E\n    if stratified\n        jl = @timed fit(E, @formula(Surv(time,status)~sex), colrec, slopop)\n        @rput r_method\n        r = @timed R\"\"\"\n            rez = relsurv::rs.surv(survival::Surv(time, stat) ~ sex, rmap=list(age = age, sex = sex, year = diag), data = relsurv::colrec, ratetable = relsurv::slopop, method = r_method, add.times=1:8149)\n        \"\"\"\n    else\n        jl = @timed fit(E, @formula(Surv(time,status)~1), colrec, slopop)\n        @rput r_method\n        r = @timed R\"\"\"\n            rez = relsurv::rs.surv(survival::Surv(time, stat) ~ 1, rmap=list(age = age, sex = sex, year = diag), data = relsurv::colrec, ratetable = relsurv::slopop, method = r_method, add.times=1:8149)\n        \"\"\"\n    end\n    return r.time / jl.time\nend\n\nfunction test_graffeo(stratified)\n    if stratified\n        jl = @timed fit(GraffeoTest, @formula(Surv(time,status)~stage+Strata(sex)), colrec, slopop)\n        r = @timed R\"\"\"\n        rez = relsurv::rs.diff(survival::Surv(time, stat) ~ stage + survival::strata(sex), rmap=list(age = age, sex = sex, year = diag), data = relsurv::colrec, ratetable = relsurv::slopop)\n        \"\"\"\n    else \n        jl = @timed fit(GraffeoTest, @formula(Surv(time,status)~stage), colrec, slopop)\n        r = @timed R\"\"\"\n        rez = relsurv::rs.diff(survival::Surv(time, stat) ~ stage, rmap=list(age = age, sex = sex, year = diag), data = relsurv::colrec, ratetable = relsurv::slopop)\n        \"\"\"\n    end\n    return r.time / jl.time \nend\ntest_all(stratified) = [\n    test_surv(\"pohar-perme\", PoharPerme, stratified),\n    test_surv(\"ederer1\", EdererI, stratified),\n    test_surv(\"ederer2\", EdererII, stratified),\n    test_surv(\"hakulinen\", Hakulinen, stratified),\n    test_graffeo(stratified),\n]\ntest_all() = DataFrame(\n    Algorithm = [\"Pohar Perme\", \"EdererI\", \"EdererII\", \"Hakulinen\", \"Graffeo's LRT\"], \n    unstratified = test_all(false), \n    stratified = test_all(true)\n)\nrez = test_all()\nrez = test_all() # discard first run.\n\n# note: to obtain the pretty printing from the readme, you need to install PrettyTables.jl and do : \n# using PrettyTables\n# pretty_table(rez, backend = Val(:markdown))\n\nrez","category":"section"},{"location":"benches/#Benchmarking-across-time","page":"Benchmarking results","title":"Benchmarking across time","text":"The following charts provide a glimpse of NetSurvival.jl's performance along time, also ran on github CI: \n\n<iframe src=\"../../benchmarks/\" style=\"height:500px;width:100%;\"></iframe>","category":"section"},{"location":"getting_started/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"In many population-based studies, the specific cause of death is unidentified, unreliable or even unavailable. Relative survival analysis addresses this scenario, previously unexplored in general survival analysis. Different methods were created with the aim to construct a consistant and reliable estimator for this purpose.","category":"section"},{"location":"getting_started/#Net-survival-settings","page":"Getting Started","title":"Net survival settings","text":"Note first that, for any positive random variable X, we will use extensively the following functions (that each fully characterize the distribution of X): \n\nFunction symbol and definition Function Name\nS_X(t) = mathbb P(X  t) Survival function\nLambda_X(t) = -ln S_X(t) Cumulative Hazard function\nlambda_X(t) = partial Lambda_X(t) Instantaneous hazard function\n\nConsider a study that consists of censored survival times from a specific cause. Such a study consists of several random objects: \n\nRandom variable Name Is it observed ?\nE \"Excess\" lifetime ✘\nP \"Population\" lifetime ✘\nO = E wedge P \"Overall\" lifetime ✘\nC \"Censoring\" time ✘\nmathbf D Vector of covariates ✔\nT = O wedge C Event time ✔\nDelta = mathbf1T leq C Event status ✔\n\nIt is important to note that we do not observe a a potential indicator mathbf1E geq P. This is one of the key differences between net survival and standard survival. The standard Net survival analysis solves this problem by assuming that the underlying times E and P are independent from each other.\n\nOne central hypothesis in net survival (on top of non-informative censoring) is that P and E are independent. This independence can be written in terms of hazard rates lambda_O(t) = lambda_P(t) + lambda_E(t), or in terms of survival functions S_O(t) = S_P(t)S_E(t).\n\nThe population hazard for each individual lambda_P_i is usally drawn from a reference life table, and may depend on covariates mathbf D_i such as age and date, sex, country, race, etc... See the RateTables.jl package for more details on the potential covariates. On the other hand, the excess mortality is assumed to be i.i.d. between individuals and not to depend on covariates at all. Thus, we mostly omit these covariates from our notations.","category":"section"},{"location":"getting_started/#Available-Estimators","page":"Getting Started","title":"Available Estimators","text":"The estimation of net survival is usually discussed in terms of the estimation of the cumulative excess hazard Lambda_E(t) and/or the instantaneous hazard lambda_E = partialLambda_E. To describe the estimators, we use the following counting processes notations, similar to standard survival analysis(see e.g. [6] or [7]). \n\nThe uncensored event indicatrix partial N_i(t) for individual i at time t \nThe total number of uncensored events process partial N(t) = sum_i partial N_i(t) at time t\nThe at-risk indicatrix Y_i(t), for whether an individual is still at risk \nThe total number at risk process Y(t) = sum_i Y_i(t) at time t\n\nWith these definitions and assumptions in mind, we will now present the four different methods implemented in this package, commonly used in literature, to estimate the excess hazard function partialLambda_E(t) and its variance. Recall that we estimate the variance as sigma_E^2(t) = int_0^t partialsigma_E^2(s). \n\nName Reference Proposed (partial) Excess Hazard partialhatLambda_E(s) Proposed (partial) Variance partialhatsigma_E^2(s)\nEderer I [1] fracsum_i N_i(s)sum_i Y_i(s) - fracsum_i S_P_i(s)partialLambda_P_i(s)sum_i S_P_i(s) fracsum_i N_i(s)left(sum_i Y_i(s)right)^2\nEderer II [2] fracsum_i N_i(s)sum_i Y_i(s) - fracsum_i Y_i(s)partialLambda_P_i(s)sum_i Y_i(s) fracsum_i N_i(s)left(sum_i Y_i(s)right)^2\nHakulinen [3] fracsum_i N_i(s)sum_i Y_i(s) - fracsum_i fracY_i(s) S_P_i(s)partialLambda_P_i(s)sum_i fracY_i(s) S_P_i(s) fracsum_i N_i(s)left(sum_i Y_i(s)right)^2\nPohar Perme [4] fracsum_i fracpartial N_i(s)S_P_i(s) - sum_i fracY_i(s)S_P_i(s)partialLambda_P_i(s)sum_i fracY_i(s)S_P_i(s) fracsum_i=1^n fracpartial N_i(s)S^2_P_i(s)left(sum_i fracY_i(s)S_p_i(s)right)^2\n\nwhere, in the variances, it is understood that when no more individuals are at risk 00 gives 0. \n\nThe Pohar Perme estimator [4] is the newest addition to relative survival analysis between the four methods, particularly designed to handle situations where covariates may change over time. It is trusted from the field (see e.g. [8] and [9]) that only this estimator should really be used, the other ones being included mostly for historical reasons and comparisons. ","category":"section"},{"location":"getting_started/#Crude-Mortality","page":"Getting Started","title":"Crude Mortality","text":"The crude mortality rate is the global mortality rate (from all causes of death) for a population. This measure does not use the cause of death information which, as we previously mentioned, can be unreliable and incomplete. It is given as:\n\nM_E(t) = int_0^t S_O(u-) lambda_E(u)du\n\nThere exists a few estimators of this quantity, the most known one being the Cronin-Feuer estimator [10], given by:\n\nhatM_E(t) = int_0^t hatS_O(u-) hatlambda_E(u)du\n\nwhere, traditionally, Kaplan-Meier is used to estimate the overall survival function hatS_O and Ederer II is used for the excess hazard rate hatlambda_E and the population hazard rate hatlambda_P.\n\nOur implementation is a bit more permissive, as any net survival estimators can be used for hatlambda_E. Of course, the default is still the original Ederer II which provides the original Cronin-Feuer estimator. ","category":"section"},{"location":"getting_started/#Grafféo-Log-Rank-Test","page":"Getting Started","title":"Grafféo Log-Rank Test","text":"The Grafféo Log-Rank Test [5] was constructed as a complement to the Pohar Perme estimator, aiming to compare the net survival functions provided by the latter. The test  is designed to compare these functions across multiple groups, including stratified covariables, and to ultimately determine, with the given p-value, which covariables are impactful to the study.\n\nThe null (H_0) hypothesis tests the following assumption:\n\nforall t in 0T   Lambda_Eg_1(t) = Lambda_Eg_2(t) =  = Lambda_Eg_k(t)\n\nwhere G = g_1g_k is a partition of 1n consisting of disjoint groups of individuals that we wish to compare to each other.  For all group g in G, let's denote the numerator and denominator of the Pohar Perme (partial) excess hazard estimators, restricted to individuals in the group, by: \n\npartial N_Eg(s) = sum_i in g fracpartial N_i(s)S_P_i(s) - fracY_i(s)S_P_i(s)partialLambda_P_i(s)\nY_Eg(s) = sum_i in g fracY_i(s)S_P_i(s)\nR_g(s) = fracY_Eg(s)sum_gin G Y_Eg(s)\n\nThen, define the vector mathbf Z = left(Z_g_r  r in 1k-1 right) with entries: \n\nZ_g(T) = N_Eg(s) - int_0^T Y_Eg(s) partialhatLambda_E(s)\n\nThe test statistic is then given by:\n\nU(T) = mathbf Z(T)hatSigma_Z^-1 mathbf Z(T)\n\nwhere the entries of the hatSigma_Z matrix are given by: \n\nsigma_gh(T) = int_0^T sum_ell in G left(delta_gell - R_g(t) right)left(delta_hell - R_h(t)right) left(sum_iinell fracpartial N_i(s)S^2_P_iright)\n\nUnder H_0, the statistic U(T) is asymptotically chi^2(k-1)-distributed. We thus reject the H_0 hypothesis when the p-value obtained is under 005, admitting the notable difference between the groups. ","category":"section"},{"location":"getting_started/#Nessie","page":"Getting Started","title":"Nessie","text":"The Nessie function estimates the sample size by yearly intervals as well as averages an estimated lifespan left for a given group.  \n\nThis function is highly dependant on the Life function taken from the RateTables.jl package which you can find documented here.\n\nThe sample size is thus taken by the following formula:\n\nESS(t) = sum_i^N S_P_i(t)\n\nWhile the estimated lifepsan is directly taken from the expectation function. ","category":"section"},{"location":"getting_started/#Relaxing-the-independence-assumption","page":"Getting Started","title":"Relaxing the independence assumption","text":"The independence assumption of the random vector (EP) can be relaxed by specifying a dependence structure for this random vector, defined by a copula from Copulas.jl. The description of the underlying method to compute the net survival, its variance and associated log-rank tests under these dependence assumptions are given in [11].\n\nThe generalization of the Pohar Perme estimator with a given copula C::Copulas.Copula can be used as follows: \n\nC = FrankCopula(2,-10)\nfit(GenPoharPerme(C), @formula(Surv(time, status)~ x1 + x2), data, ratetable)\nfit(GraffeoTest(C), @formula(Surv(time, status)~ x1 + x2), data, ratetable)\n\nBy default, GraffeoTest(C::Copula) uses GenPoharPerme(C) as a method to compute net survival in each category, but this modification also allows to use other methods, such as: \n\nfit(GraffeoTest(Ederer1()), @formula(Surv(time, status)~ x1 + x2), data, ratetable)\n\nEven if these results are not supported by any theoretical work and are probably meaningless, it is fun to to see that the code goes through, thanks to the modularity of Julia's dispatch, even on routes that were not designed for.","category":"section"},{"location":"getting_started/#Available-Datasets","page":"Getting Started","title":"Available Datasets","text":"Two classroom datasets are provided in the package: ","category":"section"},{"location":"getting_started/#References","page":"Getting Started","title":"References","text":"F. Ederer. The relative survival rate: a statistical methodology. Natl. Cancer Inst. Monogr. 6, 101–121 (1961).\n\n\n\nF. Ederer and H. Heise. The effect of eliminating deaths from cancer in general survival rates, methodological notes 11. End Result Evaluation Section, National Cancer Institute (1959).\n\n\n\nT. Hakulinen. On long-term relative survival rates. Journal of Chronic Diseases 30, 431–443 (1977).\n\n\n\nM. Pohar Perme, J. Stare and J. Estève. On Estimation in Relative Survival. Biometrics 68, 113–120 (2011).\n\n\n\nN. Grafféo, F. Castell, A. Belot and R. Giorgi. A Log-Rank-Type Test to Compare Net Survival Distributions. Biometrics 72, 760–769 (2016).\n\n\n\nT. R. Fleming and D. P. Harrington. Counting Processes and Survival Analysis. Vol. 625 (John Wiley & Sons, 2013).\n\n\n\nP. K. Andersen, O. Borgan, R. D. Gill and N. Keiding. Statistical Models Based on Counting Processes. Springer Series in Statistics (Springer US, New York, NY, 1993).\n\n\n\nM. Pohar Perme and K. Pavlic. Nonparametric relative survival analysis with the R package relsurv. Journal of Statistical Software 87, 1–27 (2018).\n\n\n\nH. Charvat and A. Belot. Mexhaz: An R package for fitting flexible hazard-based regression models for overall and excess mortality with a random effect. Journal of Statistical Software 98, 1–36 (2021).\n\n\n\nK. A. Cronin and E. J. Feuer. Cumulative cause-specific mortality for cancer patients in the presence of other causes: a crude analogue of relative survival. Statistics in medicine 19, 1729–1740 (2000).\n\n\n\nO. Laverny, N. Grafféo and R. Giorgi. Non-parametric estimation of net survival under dependence between death causes (2025), arXiv:2502.09273 [math.ST].\n\n\n\nV. Zadnik, M. P. Žakelj and M. Krajc. Cancer burden in Slovenia in comparison with the burden in other European countries. Slovenian Medical Journal 81 (2012).\n\n\n\nV. Zadnik, T. Žagar and M. P. Žakelj. Cancer patients’ survival: standard calculation methods and some considerations regarding their interpretation. Slovenian Journal of Public Health 55, 144–151 (2016).\n\n\n\nR. Giorgi, M. Abrahamowicz, C. Quantin, P. Bolard, J. Esteve, J. Gouvernet and J. Faivre. A relative survival regression model using B-spline functions to model non-proportional hazards. Statistics in medicine 22, 2767–2784 (2003).\n\n\n\nA. Wolski, N. Grafféo, R. Giorgi and the CENSUR working survival group. A Permutation Test Based on the Restricted Mean Survival Time for Comparison of Net Survival Distributions in Non-Proportional Excess Hazard Settings. Statistical Methods in Medical Research 29, 1612–1623 (2020).\n\n\n\n","category":"section"},{"location":"getting_started/#NetSurvival.PoharPerme","page":"Getting Started","title":"NetSurvival.PoharPerme","text":"PoharPerme\n\nThis method estimates net survival probabilities by applying the following estimation:\n\npartialhatLambda_E(t) = fracsum_i fracdN_i(u)S_P_i(u) - sum_i fracY_i(u)S_P_i(u)dLambda_P_i(u)sum_i fracY_i(u)S_P_i(u)\n\nTo fit the Pohar Perme to your data based on a certain rate table, apply the example below to your code : \n\nfit(PoharPerme, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)\n\nReferences: \n\n[4] Perme, Maja Pohar and Stare, Janez and Estève, Jacques (2012). On Estimation in Relative Survival.\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.EdererI","page":"Getting Started","title":"NetSurvival.EdererI","text":"EdererI\n\nThis method estimates net survival probabilities by applying the following estimation:\n\npartialhatLambda_E(t) = fracsum_i N_i(u)sum_i Y_i(u) - fracsum_i S_P_i(u)dLambda_P_i(u)sum_i S_P_i(u)\n\nTo call this function: \n\nfit(EdererI, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.EdererII","page":"Getting Started","title":"NetSurvival.EdererII","text":"EdererII\n\nThis method estimates net survival probabilities by applying the following estimation:\n\npartialhatLambda_E(t) = fracsum_i N_i(u)sum_i Y_i(u) - fracsum_i Y_i(u)dLambda_P_i(u)sum_i Y_i(u)\n\nTo call this function: \n\nfit(EdererII, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.Hakulinen","page":"Getting Started","title":"NetSurvival.Hakulinen","text":"Hakulinen\n\nTo call this function: \n\nfit(Hakulinen, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.CrudeMortality","page":"Getting Started","title":"NetSurvival.CrudeMortality","text":"CrudeMortality\n\nThis method calculates the crude mortality and presents both the excess mortality and population mortality rates.\n\nThe default Cronin-Feuer estimator can be fitted to data with the following interface: \n\nfit(CrudeMortality, args...)\n\nwhere the args are passed to fit(EdererII,args...) to compute the excess hazard.\n\nA more direct syntax can be used, specifying directly the estimator for the excess hazard:\n\nCrudeMortality(fit(EdererII,args...))\n\nTo use another excess hazard estimator, simply replace EdererII with the method of your choice (PoharPerme, EdererI, Hakulinen).\n\nReferences: \n\n[10] Cronin, Kathleen A and Feuer, Eric J (2000). Cumulative cause-specific mortality for cancer patients in the presence of other causes: a crude analogue of relative survival.\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.GraffeoTest","page":"Getting Started","title":"NetSurvival.GraffeoTest","text":"GraffeoTest\n\nThe Grafféo test is a log-rank type test and is typically used in net survival analysis to determine the impact of certain covariates in the study.\n\nThe null (H_0) hypothesis tests the following assumption:\n\nforall t in 0T Lambda_Eg_1(t) = Lambda_Eg_2(t) =  = Lambda_Eg_k(t)\n\nwhere G = g_1g_k is a partition of 1n consisting of disjoint groups of individuals that we wish to compare to each other.  For all group g in G, let's denote the numerator and denominator of the Pohar Perme (partial) excess hazard estimators, restricted to individuals in the group, by: \n\npartial N_Eg(s) = sum_i in g fracpartial N_i(s)S_P_i(s) - fracY_i(s)S_P_i(s)partialLambda_P_i(s)\nY_Eg(s) = sum_i in g fracY_i(s)S_P_i(s)\nR_g(s) = fracY_Eg(s)sum_gin G Y_Eg(s)\n\nThen, define the vector mathbf Z = left(Z_g_r r in 1k-1 right) with entries: \n\nZ_g(T) = N_Eg(s) - int_0^T Y_Eg(s) partialhatLambda_E(s)\n\nThe test statistic is then given by:\n\nU(T) = mathbf Z(T)hatSigma_Z^-1 mathbf Z(T)\n\nwhere the entries of the hatSigma_Z matrix are given by: \n\nsigma_gh(T) = int_0^T sum_ell in G left(delta_gell - R_g(t) right)left(delta_hell - R_h(t)right) left(sum_iinell fracpartial N_i(s)S^2_P_iright)\n\nUnder H_0, the statistic U(T) is asymptotically chi^2(k-1)-distributed.\n\nTo apply the test to your data based on a certain rate table, apply the example below to your code : \n\nfit(GraffeoTest, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)\n\nIf you wish to stratify a covariate:\n\nfit(GraffeoTest, @formula(Surv(time,status)~covariable1 + Strata(covariable2)), data, ratetable)\n\nThe produced test statistics is supposed to follow a chi squared distribution under (H_0). You can fetch the results using the .stat, .df and .pval fields of the returned object. \n\nReferences: \n\n[5] Grafféo, Nathalie and Castell, Fabienne and Belot, Aurélien and Giorgi, Roch (2016). A Log-Rank-Type Test to Compare Net Survival Distributions.  \n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.nessie","page":"Getting Started","title":"NetSurvival.nessie","text":"nessie\n\nTo call this function, use the formula below: \n\nnessie(@formula(Surv(time,status)~covariate), data, ratetable)\n\n\n\n\n\n","category":"function"},{"location":"getting_started/#NetSurvival.GenPoharPerme","page":"Getting Started","title":"NetSurvival.GenPoharPerme","text":"GenPoharPerme\n\nThis method estimates net survival probabilities under the generalized pohar perme method, taking into account a copula for (E,P) as described in the reference paper. You may use it as: \n\nfit(GenPoharPerme(copula), @formula(Surv(time, status)~ x1 + x2), data, ratetable)\n\nNote that GenPoharPerme(::IndependenceCopula) simply returns PoharPerme.\n\nReferences: \n\n[11] Laverny, O., Grafféo, N., & Giorgi, R. (2025). Non-parametric estimation of net survival under dependence between death causes. arXiv preprint arXiv:2502.09273.\n\n\n\n\n\n","category":"type"},{"location":"getting_started/#NetSurvival.colrec","page":"Getting Started","title":"NetSurvival.colrec","text":"colrec\n\nThe colrec dataset provides an example of relative survival dataset from slovenia, and should be paired with the slopop ratetable in the RateTables.jl package. It contains the following columns: \n\ntime, in days: follow-up time since diagnosis,\nstatus, boolean: observed death (1) or censored (0),\nage, in days: age at diagnosis,\nyear, in days since 0000-00-00: date of diagnosis,\nsex, :male or :female,\nstage, cancer stage, can be 1,2,3 or 99 (unknown),\nsite, cancer site, can be :rectum or :colon.\n\nThe 5971 patients were diagnosed with colon or rectal cancer in 1994-2000. The original source of the dataset is the relsurv R package. Data were provided by the Slovene Cancer Registry. The original data collected were slightly modified for privacy purpose and legal reason. Because of this data perturbation, neither dates nor ages correspond strictly to their real original values. This dataset is therefore provided as a pedagogical and methodological example and should not be used for medical research purposes.\n\nReferences: \n\n[8] Pohar Perme, Maja  and Pavlic, Klemen (2018). Nonparametric relative survival analysis with the R package relsurv. Journal of Statistical Software\n[12] Zadnik V, Primic Žakelj M, Krajc M (2012). Cancer Burden in Slovenia in Comparison with the Burden in Other European Countries. Zdravniški Vestnik\n[13] Zadnik V, Žagar T, Primic Žakelj M (2016). Cancer Patients’ Survival: Standard Calculation Methods and Some Considerations Regarding Their Interpretation. Zdravstveno Varstvo\n\n\n\n\n\n","category":"constant"},{"location":"getting_started/#NetSurvival.ccolon","page":"Getting Started","title":"NetSurvival.ccolon","text":"ccolon\n\nThe ccolon dataset provides an example of relative survival dataset from france, and should be paired with the survexp_fr ratetable in the RateTables.jl package. It contains the following columns: \n\ntime, in days: follow-up time since diagnosis,\nstatus, boolean: observed death (1) or censored (0),\nage, in days: age at diagnosis,\nyear, in days since 0000-00-00: date of diagnosis,\nsex, :male or :female,\nstage, interger from 0 to 3, correspnding to Cancer TNM (tumor node metastatis) stages at diagnosis, either I, II, III, IIIb or IV. \nside, the primary tumor location, either :right or :left of the colon.\n\nThis dataset has been studied in [14], [15] and [11]. It contains population-based survival data on cases of colorectal cancer from the Registry of Digestive Cancers in Burgundy, France, diagnosed between 1976 and 1990. Patients were censored 1) after 10 years of followup and 2) on the 31 December 1994. The original data collected were slightly modified for privacy purpose and legal reason. Because of this data perturbation, neither dates nor ages correspond strictly to their real original values. This dataset is therefore provided as a pedagogical and methodological example and should not be used for medical research purposes.\n\nReferences: \n\n[14] Giorgi, Roch and Abrahamowicz, Michal and Quantin, Catherine and Bolard, Philippe and Esteve, Jacques and Gouvernet, Joanny and Faivre, Jean. A relative survival regression model using B-spline functions to model non-proportional hazards. Statistics in medicine\n[15] Wolski, Anna and Graff{'e}o, Nathalie and Giorgi, Roch and {the CENSUR working survival group}. A Permutation Test Based on the Restricted Mean Survival Time for Comparison of Net Survival Distributions in Non-Proportional Excess Hazard Settings. Statistical Methods in Medical Research.\n[11] Laverny, O., Grafféo, N., & Giorgi, R. (2025). Non-parametric estimation of net survival under dependence between death causes. arXiv preprint arXiv:2502.09273.\n\n\n\n\n\n","category":"constant"},{"location":"#Introduction","page":"Home","title":"Introduction","text":"The NetSurvival.jl package provides the necessary tools to perform estimations and analysis in the Net Survival field. This specialized branch of Survival Analysis focuses on estimating the probability of survival from a specific event of interest, for example a given cancer, without considering other causes of death. This is especially relevant in the (unfortunately quite common) case where the cause of death indicatrix is either unavailable or untrustworthy. Consequently, the so-called missing indicatrix issue forbids the use of standard competitive risks survival analysis methods on these datasets.  For that, a few standard estimators were established in the last 50 years, backed by a wide literature.\n\nBy integrating observed data from the target population with historical population mortality data (usually sourced from national census datasets), Net Survival allows the extraction of the specific mortality hazard associated with the particular disease, even under the missing indicatrix issue. The concept of relative survival analysis dates back several decades to the seminal article by Ederer, Axtell, and Cutler in 1961 [1] and the one by Ederer and Heise in 1959 [2].\n\nFor years, the Hakulinen estimator (1977) [3] and the Ederer I and II estimators were widely regarded as the gold standard for non-parametric survival curve estimation. However, the introduction of the Pohar Perme, Stare, and Estève estimator in 2012 [4] resolved several issues inherent in previous estimators, providing a reliable and consistent non-parametric estimator for net survival analysis.","category":"section"},{"location":"#Features","page":"Home","title":"Features","text":"Standard tools nowadays are composed of R packages, with underlying C and C++ routines, that are hard to read, maintain, and use. This package is an attempt to bring standard relative survival analysis modeling routines to Julia, while providing an interface that is close to the relsurv standard, albeit significantly faster and easier to maintain in the future. Our hope is that the junction with classical modeling API in Julia will allow later extensions of the existing modeling methods, with a simple interface for the practitioners.\n\nSome key features in NetSurvival.jl are:\n\nA panel of different non-parametric net survival estimators (Ederer I [1], Ederer II [2], Hakulinen [3], Pohar Perme [4]) with an interface compliant with Julia's standards. \nGrafféo's log-rank test [5] to compare net survival curves accross groups, including stratified testing.\nCrude mortality, Expected Sample Size, and other useful metrics in net survival field.\nA 'Nessie' function that outputs the estimated sample size by yearly intervals and the average lifespan expectancy left for a given group. \nA compact, readable and efficient codebase (up to 1000x less LOC than relsurv for the same functionalities), ensuring long-term maintenability.\nSignificant performance improvements (up to 50x) compared to the R package relsurv.","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"The package is available on Julia's general registry, and thus can be installed through the following command:\n\n] add NetSurvival\n\nSee the rest of this documentation to have a glimpse of the functionalities!","category":"section"},{"location":"#References","page":"Home","title":"References","text":"F. Ederer. The relative survival rate: a statistical methodology. Natl. Cancer Inst. Monogr. 6, 101–121 (1961).\n\n\n\nF. Ederer and H. Heise. The effect of eliminating deaths from cancer in general survival rates, methodological notes 11. End Result Evaluation Section, National Cancer Institute (1959).\n\n\n\nT. Hakulinen. On long-term relative survival rates. Journal of Chronic Diseases 30, 431–443 (1977).\n\n\n\nM. Pohar Perme, J. Stare and J. Estève. On Estimation in Relative Survival. Biometrics 68, 113–120 (2011).\n\n\n\nN. Grafféo, F. Castell, A. Belot and R. Giorgi. A Log-Rank-Type Test to Compare Net Survival Distributions. Biometrics 72, 760–769 (2016).\n\n\n\n","category":"section"},{"location":"example/#Case-study","page":"Case study","title":"Case study","text":"","category":"section"},{"location":"example/#Introduction-and-datasets","page":"Case study","title":"Introduction and datasets","text":"We will illustrate with an example using the dataset colrec, which comprises 5971 patients diagnosed with colon or rectal cancer between 1994 and 2000. This dataset is sourced from the Slovenia cancer registry. Given the high probability that the patients are Slovenian, we will be using the Slovenian mortality table slopop as reference for the population mortality rates. Subsequently, we can apply various non-parametric estimators for net survival analysis.\n\nnote: N.B.\nMortality tables may vary in structure, with options such as the addition or removal of specific covariates. To confirm that the mortality table is in the correct format, please refer to RateTables.jl's documentation, or directly extract it from there.","category":"section"},{"location":"example/#Cohort-details","page":"Case study","title":"Cohort details","text":"The patients in the study are diagnosed between January 1st 1994 and December 31st 2000. Before we move on to the survival probabilities, it is important to be aware of how your data is distributed and of what it comprises. \n\nusing NetSurvival, RateTables, DataFrames\nfirst(colrec,10)\n\nLet's explore how our data is distributed first, starting with the age variable.\n\nprintln(minimum(colrec.age./365.241), \" ; \",maximum(colrec.age./365.241))\n\nThe study can be considered diverse in terms of age seeing as the patients are between 12 and 96 years old, approximately. \n\nusing Plots \nplot(histogram(colrec.age./365.241, label=\"Age\"),\n    histogram(colrec.time./365.241, label=\"Follow-up time\"))\n\nThe graph above show us that although the dataset has a wide range of patients within all age groups, it is mostly centered around older adults and elderly, with the majority of the patients being between 60 and 80 years old. Looking at the second graph that details the distribution of the follow-up times. We notice there that the values quickly drop. Unfortunately, this is a common theme in cancer studies. \n\nLet's take a look at the sex variable now, by looking at the number of male and female patients:\n\ncombine(groupby(colrec, :sex), nrow)\n\nThere isn't too big of a difference between the two. We can say this study includes both gender relatively equally, thus, reducing bias. With these two observations, it is also worth noting that colorectal cancer is most common with men and people older than 50.\n\nIn total, we note that we have 5971 patients. By taking a look at the status variable, we can determine the deaths and censorship:\n\nsum(colrec.status)\n\nOut of the 5971 patients, 4979 have died. This is a very high mortality rate, and again, unfortunately common in cancer studies.\n\n(nrow(colrec) - sum(colrec.status)) / nrow(colrec)\n\nIn other terms, the censorship rate is of 16.6%, meaning the event, in this case death, was not observed for only 16.6% of the patients. This is a low censorship rate and thus the quality of the signal will be pretty good. ","category":"section"},{"location":"example/#Mortality-table","page":"Case study","title":"Mortality table","text":"We will be using the mortality table slopop taken from the RateTables.jl package as the study is done on Slovenian patients. \n\nslopop\n\nThe show method of the RateTable class shows the additional covariate sex that the rate table has on top of the (mandatory) age and year variables. The sex variable has two madalities, :male and :female. The ratetable is then three dimensional. For example, the daily hazard rate for a woman turning 45 on the January 1st 2006 can be accessed through the following command:\n\nλ  = daily_hazard(slopop, 45*365.241, 2006*365.241; sex=:female)\n\nMaking the daily survival probability easily calculated with:\n\nexp(-λ)","category":"section"},{"location":"example/#Overall-and-expected-survival","page":"Case study","title":"Overall and expected survival","text":"For this part, we will be using the Survival.jl package to apply the Kaplan Meier estimator for the overall survival.\n\nusing Survival \nkm = fit(KaplanMeier, colrec.time./365.241, colrec.status)\nplot(km.events.time, km.survival, label=false, title = \"Kaplan-Meier Estimator for the Overall Survival\")\n\nThe graph above indicates a significant dip in survival probability within the first 5 years, and even more at 10 years. This period in the study is then crucial for the analysis. ","category":"section"},{"location":"example/#Estimated-net-survival","page":"Case study","title":"Estimated net survival","text":"We will restrict ourselves to the first 5 years of the study. For that, let us re-censor the dataset as follows: \n\nfor i in 1:nrow(colrec)\n    if colrec.time[i] > 1826 # five years\n        colrec.status[i] = false\n        colrec.time[i] = 1826\n    end\nend\n\nWe can now apply the different non-parametric methods to compute the relative survival.\n\ne1 = fit(EdererI, @formula(Surv(time,status)~1), colrec, slopop)\n\nWith the EdererI method, after 1826 days have passed, we can say that the survival rate at this mark is around 0456, in the hypothetical world where patients can only die of cancer.\n\ncrude_e1 = CrudeMortality(e1)\nprintln(crude_e1.Mₒ[1826], \" , \", crude_e1.Mₑ[1826], \" , \", crude_e1.Mₚ[1826])\n\nOut of the 0.63 patients that have died, according to the EdererI method, 0.51 died because of colorectal cancer and 0.12 died of other causes.\n\ne2 = fit(EdererII, @formula(Surv(time,status)~1), colrec, slopop)\n\nSimilarly, the EdererII method, also known as the conditional method, shows that at the 5 year mark, the survival probability is of 044 in this hypothetical world.\n\ncrude_e2 = CrudeMortality(e2)\nprintln(crude_e2.Mₒ[1826], \" , \", crude_e2.Mₑ[1826], \" , \", crude_e2.Mₚ[1826])\n\nHere, out of the 0.63 patients that have died, 0.53 are due to colorectal cancer and 0.1 due to other causes.\n\npp = fit(PoharPerme, @formula(Surv(time,status)~1), colrec, slopop)\n\nWe conclude for the Pohar Perme method, that in a world where cancer patients could only die due to cancer, only 41% of these patients would still be alive 5 year after their diagnosis. The Pohar Perme estimator is the best estimator of the excess hazard under the standard hypotheses. \n\ncrude_pp = CrudeMortality(pp)\nprintln(crude_pp.Mₒ[1826], \" , \", crude_pp.Mₑ[1826], \" , \", crude_pp.Mₚ[1826])\n\nFinally, for this estimator, we have that of the 0.64 patients that have died, 0.53 is due to colorectal cancer while 0.11 is due to other causes.\n\nWe will plot the Pohar Perme method only.\n\nfunction mkribbon(pp)\n    S = pp.Sₑ\n    ci = confint(pp; level = 0.05)\n    l,u = getindex.(ci, 1), getindex.(ci,2)\n    rb = (S - l, u - S)\n    return rb\nend\n\np1 = plot(pp.grid, pp.Sₑ, ribbon=mkribbon(pp), xlab = \"Time (days)\", ylab = \"Net survival\", label = false)\n\np2 = plot(pp.grid, crude_pp.Mₑ, label = \"Excess Mortality Rate\")\np2 = plot!(pp.grid, crude_pp.Mₚ, label = \"Population Mortality Rate\")\n\nplot(p1,p2)\n\nLooking at the graph, and the rapid dip it takes, it is evident that the first 5 years are crucial and that the survival probability is highly affected in these years. Additionally, the crude mortality graph allows us to see how much of this curve is due to the colorectal cancer studied versus other undefined causes. It is clear that the large majority is due to the cancer.","category":"section"},{"location":"example/#Net-survival-with-respect-to-covariates","page":"Case study","title":"Net survival with respect to covariates","text":"We are now interested in comparing the different groups of patients defined by various covariates. \n\npp_sex = fit(PoharPerme, @formula(Surv(time,status)~sex), colrec, slopop)\npp_males = pp_sex[pp_sex.sex .== :male,:estimator][1]\npp_females = pp_sex[pp_sex.sex .== :female,:estimator][1]\n\nWhen comparing at time 1826, we notice that the survival probability is slightly inferior for men than for women (0433  0449). It is also more probable for the women to die from other causes than the men seeing as 00255  0025. Still, the differences are minimal. Let's confirm this with the Grafféo log-rank test:\n\ntest_sex = fit(GraffeoTest, @formula(Surv(time,status)~sex), colrec, slopop)\n\nThe p-value is indeed above 005. We cannot reject the null hypothesis H_0 and thus we dismiss the differences between the two sexes.\n\nAs for the age, we will define two different groups: individuals aged 65 and above and those who are not.\n\ncolrec.age65 .= ifelse.(colrec.age .>= 65*365.241, :old, :young)\npp_age65 = fit(PoharPerme, @formula(Surv(time,status)~age65), colrec, slopop)\npp_young = pp_age65[pp_age65.age65 .== :young, :estimator][1]\npp_old = pp_age65[pp_age65.age65 .== :old, :estimator][1]\n\nHere, the difference between the two is much more important. In the first group, the individuals are aged under 65 and at 5 years time, they have a 501% chance of survival. On the other hand, the individuals aged 65 and up have a 401% chance of survival. \n\nIt is also worth noting that their chances of dying from other causes is higher than the younger group, given their age. \n\nWhen applying the Grafféo test, we get the results below:\n\ntest_age65 = fit(GraffeoTest, @formula(Surv(time,status)~age65), colrec, slopop)\n\nThe p-value is well under 005, meaning we reject the H_0 hypothesis and must admit there are differences between the individuals aged 65 and above and the others.\n\nWhen plotting both we get:\n\nplot1 = plot(pp_males.grid, pp_males.Sₑ, ribbon=mkribbon(pp_males), xlab = \"Time (days)\", ylab = \"Net survival\", label = \"men\")\nplot1 = plot!(plot1, pp_females.grid, pp_females.Sₑ, ribbon=mkribbon(pp_females), label = \"women\")\n\nplot2 = plot(pp_young.grid, pp_young.Sₑ, ribbon=mkribbon(pp_young), xlab = \"Time (days)\", ylab = \"Net survival\", label = \"Under 65\")\nplot2 = plot!(pp_old.grid, pp_old.Sₑ, ribbon=mkribbon(pp_old), label = \"65 and up\")\n\nplot(plot1, plot2, layout = (1, 2))\n\nVisually, it is almost immediately understood that there are no worthy differences between the two sexes whereas the age65 variable seems to play a big role.\n\nThe same kind of graph can be made on the stage: \n\npp3 = fit(PoharPerme, @formula(Surv(time,status)~stage), colrec, slopop)\nplot3 = plot(xlab = \"Time (days)\", ylab = \"Net survival\",title=\"Net survival per cancer stages\")\nfor i in 1:nrow(pp3)\n    e = pp3[i,:estimator]\n    plot!(plot3, e.grid, e.Sₑ, ribbon=mkribbon(e), label=pp3[i,:stage])\nend\nplot(plot3)","category":"section"},{"location":"example/#Estimated-sample-size-and-life-expectancy","page":"Case study","title":"Estimated sample size and life expectancy","text":"Given that the age group plays a significant role in the study, we will now estimate the sample size by yearly intervals in order to better compare the age groups.\n\nelt, ess = nessie(@formula(Surv(time,status)~age65), colrec, slopop)\nelt\n\nThe expected life time for the younger patients is significatively higher than for older patients (24.78 years > 10.29 years).\n\nhcat(ess[:,3]...)\n\nFinally, the table above represents yearly expected sample sizes for both age groups under 65 and above, with the second column representing the latter. We can see that the sample size decreases for the older patients in a much more dramatic way than for the younger ages.\n\nUnsurprisingly, we can thus conclude that age plays an important role in the study.","category":"section"}]
}
