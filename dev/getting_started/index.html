<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · NetSurvival.jl</title><meta name="title" content="Getting Started · NetSurvival.jl"/><meta property="og:title" content="Getting Started · NetSurvival.jl"/><meta property="twitter:title" content="Getting Started · NetSurvival.jl"/><meta name="description" content="Documentation for NetSurvival.jl."/><meta property="og:description" content="Documentation for NetSurvival.jl."/><meta property="twitter:description" content="Documentation for NetSurvival.jl."/><meta property="og:url" content="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><meta property="twitter:url" content="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><link rel="canonical" href="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NetSurvival.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Net-survival-settings"><span>Net survival settings</span></a></li><li><a class="tocitem" href="#Available-Estimators"><span>Available Estimators</span></a></li><li><a class="tocitem" href="#Crude-Mortality"><span>Crude Mortality</span></a></li><li><a class="tocitem" href="#Grafféo-Log-Rank-Test"><span>Grafféo Log-Rank Test</span></a></li><li><a class="tocitem" href="#Nessie"><span>Nessie</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../example/">Case study</a></li><li><a class="tocitem" href="../benches/">Benchmarking results</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSurv/NetSurvival.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/main/docs/src/getting_started.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><p>In many population-based studies, the specific cause of death is unidentified, unreliable or even unavailable. Relative survival analysis addresses this scenario, previously unexplored in general survival analysis. Different methods were created with the aim to construct a consistant and reliable estimator for this purpose.</p><h2 id="Net-survival-settings"><a class="docs-heading-anchor" href="#Net-survival-settings">Net survival settings</a><a id="Net-survival-settings-1"></a><a class="docs-heading-anchor-permalink" href="#Net-survival-settings" title="Permalink"></a></h2><p>Note first that, for any positive random variable <span>$X$</span>, we will use extensively the following functions (that each fully characterize the distribution of <span>$X$</span>): </p><table><tr><th style="text-align: left">Function symbol and definition</th><th style="text-align: left">Function Name</th></tr><tr><td style="text-align: left"><span>$S_X(t) = \mathbb P(X &gt; t)$</span></td><td style="text-align: left">Survival function</td></tr><tr><td style="text-align: left"><span>$\Lambda_X(t) = -\ln S_X(t)$</span></td><td style="text-align: left">Cumulative Hazard function</td></tr><tr><td style="text-align: left"><span>$\lambda_X(t) = \partial \Lambda_X(t)$</span></td><td style="text-align: left">Instantaneous hazard function</td></tr></table><p>Consider a study that consists of censored survival times from a specific cause. Such a study consists of several random objects: </p><table><tr><th style="text-align: left">Random variable</th><th style="text-align: left">Name</th><th style="text-align: center">Is it observed ?</th></tr><tr><td style="text-align: left"><span>$E$</span></td><td style="text-align: left">&quot;Excess&quot; lifetime</td><td style="text-align: center">✘</td></tr><tr><td style="text-align: left"><span>$P$</span></td><td style="text-align: left">&quot;Population&quot; lifetime</td><td style="text-align: center">✘</td></tr><tr><td style="text-align: left"><span>$O = E \wedge P$</span></td><td style="text-align: left">&quot;Overall&quot; lifetime</td><td style="text-align: center">✘</td></tr><tr><td style="text-align: left"><span>$C$</span></td><td style="text-align: left">&quot;Censoring&quot; time</td><td style="text-align: center">✘</td></tr><tr><td style="text-align: left"><span>$\mathbf D$</span></td><td style="text-align: left">Vector of covariates</td><td style="text-align: center">✔</td></tr><tr><td style="text-align: left"><span>$T = O \wedge C$</span></td><td style="text-align: left">Event time</td><td style="text-align: center">✔</td></tr><tr><td style="text-align: left"><span>$\Delta = \mathbf{1}\{T \leq C\}$</span></td><td style="text-align: left">Event status</td><td style="text-align: center">✔</td></tr></table><p>It is important to note that we do not observe a a potential indicator <span>$\mathbf{1}\{E \geq P\}$</span>. This is one of the key differences between net survival and standard survival. The standard Net survival analysis solves this problem by assuming that the underlying times <span>$E$</span> and <span>$P$</span> are independent from each other.</p><p>One central hypothesis in net survival (on top of non-informative censoring) is that <span>$P$</span> and <span>$E$</span> are independent. This independence can be written in terms of hazard rates <span>$\lambda_O(t) = \lambda_P(t) + \lambda_E(t)$</span>, or in terms of survival functions <span>$S_O(t) = S_P(t)S_E(t)$</span>.</p><p>The population hazard for each individual <span>$\lambda_{P_i}$</span> is usally drawn from a reference life table, and may depend on covariates <span>$\mathbf D_i$</span> such as age and date, sex, country, race, etc... See the <a href="https://github.com/JuliaSurv/RateTables.jl">RateTables.jl</a> package for more details on the potential covariates. On the other hand, the excess mortality is assumed to be i.i.d. between individuals and not to depend on covariates at all. Thus, we mostly omit these covariates from our notations.</p><h2 id="Available-Estimators"><a class="docs-heading-anchor" href="#Available-Estimators">Available Estimators</a><a id="Available-Estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Estimators" title="Permalink"></a></h2><p>The estimation of net survival is usually discussed in terms of the estimation of the cumulative excess hazard <span>$\Lambda_E(t)$</span> and/or the instantaneous hazard <span>$\lambda_E = \partial\Lambda_E$</span>. To describe the estimators, we use the following counting processes notations, similar to standard survival analysis(see e.g. [<a href="../references/#FlemingHarington2013">6</a>] or [<a href="../references/#ABGK1993">7</a>]). </p><ul><li>The uncensored event indicatrix <span>$\partial N_i(t)$</span> for individual <span>$i$</span> at time <span>$t$</span> </li><li>The total number of uncensored events process <span>$\partial N(t) = \sum_i \partial N_i(t)$</span> at time <span>$t$</span></li><li>The at-risk indicatrix <span>$Y_i(t)$</span>, for whether an individual is still at risk </li><li>The total number at risk process <span>$Y(t) = \sum_i Y_i(t)$</span> at time <span>$t$</span></li></ul><p>With these definitions and assumptions in mind, we will now present the four different methods implemented in this package, commonly used in literature, to estimate the excess hazard function <span>$\partial\Lambda_E(t)$</span> and its variance. Recall that we estimate the variance as <span>$\sigma_E^2(t) = \int_{0}^t \partial\sigma_E^2(s)$</span>. </p><table><tr><th style="text-align: left">Name</th><th style="text-align: left">Reference</th><th style="text-align: left">Proposed (partial) Excess Hazard <span>$\partial\hat{\Lambda}_E(s)$</span></th><th style="text-align: left">Proposed (partial) Variance <span>$\partial\hat{\sigma}_E^2(s)$</span></th></tr><tr><td style="text-align: left">Ederer I</td><td style="text-align: left">[<a href="../references/#Ederer1961">1</a>]</td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\sum_i Y_i(s)} - \frac{\sum_i S_{P_i}(s)\partial\Lambda_{P_i}(s)}{\sum_i S_{P_i}(s)}$</span></td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\left(\sum_i Y_i(s)\right)^2}$</span></td></tr><tr><td style="text-align: left">Ederer II</td><td style="text-align: left">[<a href="../references/#Ederer1959">2</a>]</td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\sum_i Y_i(s)} - \frac{\sum_i Y_i(s)\partial\Lambda_{P_i}(s)}{\sum_i Y_i(s)}$</span></td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\left(\sum_i Y_i(s)\right)^2}$</span></td></tr><tr><td style="text-align: left">Hakulinen</td><td style="text-align: left">[<a href="../references/#Hakulinen1977">3</a>]</td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\sum_i Y_i(s)} - \frac{\sum_i \frac{Y_i(s)}{ S_{P_i}(s)}\partial\Lambda_{P_i}(s)}{\sum_i \frac{Y_i(s)}{ S_{P_i}(s)}}$</span></td><td style="text-align: left"><span>$\frac{\sum_i N_i(s)}{\left(\sum_i Y_i(s)\right)^2}$</span></td></tr><tr><td style="text-align: left">Pohar Perme</td><td style="text-align: left">[<a href="../references/#PoharPerme2012">4</a>]</td><td style="text-align: left"><span>$\frac{\sum_i \frac{\partial N_i(s)}{S_{P_i}(s)} - \sum_i \frac{Y_i(s)}{S_{P_i}(s)}\partial\Lambda_{P_i}(s)}{\sum_i \frac{Y_i(s)}{S_{P_i}(s)}}$</span></td><td style="text-align: left"><span>$\frac{\sum_{i=1}^n \frac{\partial N_i(s)}{S^2_{P_i}}}{\left(\sum_i \frac{Y_i(s)}{S_{p_i}(s)}\right)^2}$</span></td></tr></table><p>where, in the variances, it is understood that when no more individuals are at risk <span>$0/0$</span> gives <span>$0$</span>. </p><p>The Pohar Perme estimator [<a href="../references/#PoharPerme2012">4</a>] is the newest addition to relative survival analysis between the four methods, particularly designed to handle situations where covariates may change over time. It is trusted from the field (see e.g. [<a href="../references/#PermePavlik2018">8</a>] and [<a href="../references/#CharvatBelot2021">9</a>]) that only this estimator should really be used, the other ones being included mostly for historical reasons and comparisons. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.PoharPerme" href="#NetSurvival.PoharPerme"><code>NetSurvival.PoharPerme</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PoharPerme</code></pre><p>This method estimates net survival probabilities by applying the following estimation:</p><p class="math-container">\[\partial\hat{\Lambda}_E(t) = \frac{\sum_i \frac{dN_i(u)}{S_{P_i}(u)} - \sum_i \frac{Y_i(u)}{S_{P_i}(u)}d\Lambda_{P_i}(u)}{\sum_i \frac{Y_i(u)}{S_{P_i}(u)}}\]</p><p>To fit the Pohar Perme to your data based on a certain rate table, apply the example below to your code : </p><pre><code class="nohighlight hljs">fit(PoharPerme, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre><p>References: </p><ul><li>[<a href="../references/#PoharPerme2012">4</a>] Perme, Maja Pohar and Stare, Janez and Estève, Jacques (2012). On Estimation in Relative Survival.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/PoharPerme.jl#L3-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.EdererI" href="#NetSurvival.EdererI"><code>NetSurvival.EdererI</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EdererI</code></pre><p>This method estimates net survival probabilities by applying the following estimation:</p><p class="math-container">\[\partial\hat{\Lambda}_E(t) = \frac{\sum_i N_i(u)}{\sum_i Y_i(u)} - \frac{\sum_i S_{P_i}(u)d\Lambda_{P_i}(u)}{\sum_i S_{P_i}(u)}\]</p><p>To call this function: </p><pre><code class="nohighlight hljs">fit(EdererI, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/EdererI.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.EdererII" href="#NetSurvival.EdererII"><code>NetSurvival.EdererII</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EdererII</code></pre><p>This method estimates net survival probabilities by applying the following estimation:</p><p class="math-container">\[\partial\hat{\Lambda}_E(t) = \frac{\sum_i N_i(u)}{\sum_i Y_i(u)} - \frac{\sum_i Y_i(u)d\Lambda_{P_i}(u)}{\sum_i Y_i(u)}\]</p><p>To call this function: </p><pre><code class="nohighlight hljs">fit(EdererII, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/EdererII.jl#L3-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.Hakulinen" href="#NetSurvival.Hakulinen"><code>NetSurvival.Hakulinen</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Hakulinen</code></pre><p>To call this function: </p><pre><code class="nohighlight hljs">fit(Hakulinen, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/Hakulinen.jl#L3-L9">source</a></section></article><h2 id="Crude-Mortality"><a class="docs-heading-anchor" href="#Crude-Mortality">Crude Mortality</a><a id="Crude-Mortality-1"></a><a class="docs-heading-anchor-permalink" href="#Crude-Mortality" title="Permalink"></a></h2><p>The <em>crude mortality rate</em> is the global mortality rate (from all causes of death) for a population. This measure does not use the cause of death information which, as we previously mentioned, can be unreliable and incomplete. It is given as:</p><p class="math-container">\[F_C(t) = \int_0^t S_O(u-) \lambda_E(u)du\]</p><p>There exists a few estimators of this quantity, the most known one being the Cronin-Feuer estimator [<a href="../references/#cronin2000cumulative">10</a>], given by:</p><p class="math-container">\[\hat{F}_C(t) = \int_0^t \hat{S}_O(u-) \hat{\lambda}_E(u)du\]</p><p>where, traditionally, Kaplan-Meier is used to estimate the overall survival function <span>$\hat{S}_O$</span> and Ederer II is used for the excess hazard rate <span>$\hat{\lambda}_E$</span> and the population hazard rate <span>$\hat{\lambda}_P$</span>.</p><p>Our implementation is a bit more permissive, as any net survival estimators can be used for <span>$\hat{\lambda}_E$</span>. Of course, the default is still the original Ederer II which provides the original Cronin-Feuer estimator. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.CrudeMortality" href="#NetSurvival.CrudeMortality"><code>NetSurvival.CrudeMortality</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CrudeMortality</code></pre><p>This method calculates the crude mortality and presents both the excess mortality and population mortality rates.</p><p>The default Cronin-Feuer estimator can be fitted to data with the following interface: </p><pre><code class="nohighlight hljs">fit(CrudeMortality, args...)</code></pre><p>where the <code>args</code> are passed to <code>fit(EdererII,args...)</code> to compute the excess hazard.</p><p>A more direct syntax can be used, specifying directly the estimator for the excess hazard:</p><pre><code class="nohighlight hljs">CrudeMortality(fit(EdererII,args...))</code></pre><p>To use another excess hazard estimator, simply replace <code>EdererII</code> with the method of your choice (<code>PoharPerme</code>, <code>EdererI</code>, <code>Hakulinen</code>).</p><p>References: </p><ul><li>[<a href="../references/#cronin2000cumulative">10</a>] Cronin, Kathleen A and Feuer, Eric J (2000). Cumulative cause-specific mortality for cancer patients in the presence of other causes: a crude analogue of relative survival.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/CrudeMortality.jl#L1-L20">source</a></section></article><h2 id="Grafféo-Log-Rank-Test"><a class="docs-heading-anchor" href="#Grafféo-Log-Rank-Test">Grafféo Log-Rank Test</a><a id="Grafféo-Log-Rank-Test-1"></a><a class="docs-heading-anchor-permalink" href="#Grafféo-Log-Rank-Test" title="Permalink"></a></h2><p>The Grafféo Log-Rank Test [<a href="../references/#Graffeo2016">5</a>] was constructed as a complement to the Pohar Perme estimator, aiming to compare the net survival functions provided by the latter. The test  is designed to compare these functions across multiple groups, including stratified covariables, and to ultimately determine, with the given p-value, which covariables are impactful to the study.</p><p>The null <span>$(H_0)$</span> hypothesis tests the following assumption:</p><p class="math-container">\[\forall t \in [0,T], \; \; \Lambda_{E,g_1}(t) = \Lambda_{E,g_2}(t) = ... = \Lambda_{E,g_k}(t),\]</p><p>where <span>$G = \{g_1,...,g_k\}$</span> is a partition of <span>$1,...,n$</span> consisting of disjoint groups of individuals that we wish to compare to each other.  For all group <span>$g \in G$</span>, let&#39;s denote the numerator and denominator of the Pohar Perme (partial) excess hazard estimators, restricted to individuals in the group, by: </p><ul><li><span>$\partial N_{E,g}(s) = \sum_{i \in g} \frac{\partial N_i(s)}{S_{P_i}(s)} - \frac{Y_i(s)}{S_{P_i}(s)}\partial\Lambda_{P_i}(s)$</span></li><li><span>$Y_{E,g}(s) = \sum_{i \in g} \frac{Y_i(s)}{S_{P_i}(s)}$</span></li><li><span>$R_{g}(s) = \frac{Y_{E,g}(s)}{\sum_{g\in G} Y_{E,g}(s)}$</span></li></ul><p>Then, define the vector <span>$\mathbf Z = \left(Z_{g_r}: \; r \in 1,...,k-1 \right)$</span> with entries: </p><p class="math-container">\[Z_g(T) = N_{E,g}(s) - \int_{0}^T Y_{E,g}(s) \partial\hat{\Lambda}_E(s)\]</p><p>The test statistic is then given by:</p><p class="math-container">\[U(T) = \mathbf Z(T)&#39;\hat{\Sigma}_Z^{-1} \mathbf Z(T)\]</p><p>where the entries of the <span>$\hat{\Sigma}_Z$</span> matrix are given by: </p><p class="math-container">\[\sigma_{g,h}(T) = \int_0^T \sum_{\ell \in G} \left(\delta_{g,\ell} - R_g(t) \right)\left(\delta_{h,\ell} - R_h(t)\right) \left(\sum_{i\in\ell} \frac{\partial N_i(s)}{S^2_{P_i}}\right)\]</p><p>Under <span>$H_0$</span>, the statistic <span>$U(T)$</span> is asymptotically <span>$\chi^2(k-1)$</span>-distributed. We thus reject the <span>$H_0$</span> hypothesis when the p-value obtained is under <span>$0.05$</span>, admitting the notable difference between the groups. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.GraffeoTest" href="#NetSurvival.GraffeoTest"><code>NetSurvival.GraffeoTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GraffeoTest</code></pre><p>The Grafféo test is a log-rank type test and is typically used in net survival analysis to determine the impact of certain covariates in the study.</p><p>The null <span>$(H_0)$</span> hypothesis tests the following assumption:</p><p class="math-container">\[\forall t \in [0,T], \Lambda_{E,g_1}(t) = \Lambda_{E,g_2}(t) = ... = \Lambda_{E,g_k}(t)\]</p><p>where <span>$G = {g_1,...,g_k}$</span> is a partition of <span>$1,...,n$</span> consisting of disjoint groups of individuals that we wish to compare to each other.  For all group <span>$g \in G$</span>, let&#39;s denote the numerator and denominator of the Pohar Perme (partial) excess hazard estimators, restricted to individuals in the group, by: </p><ul><li><span>$\partial N_{E,g}(s) = \sum_{i \in g} \frac{\partial N_i(s)}{S_{P_i}(s)} - \frac{Y_i(s)}{S_{P_i}(s)}\partial\Lambda_{P_i}(s)$</span></li><li><span>$Y_{E,g}(s) = \sum_{i \in g} \frac{Y_i(s)}{S_{P_i}(s)}$</span></li><li><span>$R_{g}(s) = \frac{Y_{E,g}(s)}{\sum_{g\in G} Y_{E,g}(s)}$</span></li></ul><p>Then, define the vector <span>$\mathbf Z = \left(Z_{g_r}: r \in 1,...,k-1 \right)$</span> with entries: </p><p class="math-container">\[Z_g(T) = N_{E,g}(s) - \int_{0}^T Y_{E,g}(s) \partial\hat{\Lambda}_E(s)\]</p><p>The test statistic is then given by:</p><p class="math-container">\[U(T) = \mathbf Z(T)&#39;\hat{\Sigma}_Z^{-1} \mathbf Z(T)\]</p><p>where the entries of the <span>$\hat{\Sigma}_Z$</span> matrix are given by: </p><p class="math-container">\[\sigma_{g,h}(T) = \int_0^T \sum_{\ell \in G} \left(\delta_{g,\ell} - R_g(t) \right)\left(\delta_{h,\ell} - R_h(t)\right) \left(\sum_{i\in\ell} \frac{\partial N_i(s)}{S^2_{P_i}}\right)\]</p><p>Under <span>$H_0$</span>, the statistic <span>$U(T)$</span> is asymptotically <span>$\chi^2(k-1)$</span>-distributed.</p><p>To apply the test to your data based on a certain rate table, apply the example below to your code : </p><pre><code class="nohighlight hljs">fit(GraffeoTest, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre><p>If you wish to stratify a covariate:</p><pre><code class="nohighlight hljs">fit(GraffeoTest, @formula(Surv(time,status)~covariable1 + Strata(covariable2)), data, ratetable)</code></pre><p>The produced test statistics is supposed to follow a chi squared distribution under <span>$(H_0)$</span>. You can fetch the results using the <code>.stat</code>, <code>.df</code> and <code>.pval</code> fields of the returned object. </p><p>References: </p><ul><li>[<a href="../references/#Graffeo2016">5</a>] Grafféo, Nathalie and Castell, Fabienne and Belot, Aurélien and Giorgi, Roch (2016). A Log-Rank-Type Test to Compare Net Survival Distributions.  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/GraffeoTest.jl#L1-L51">source</a></section></article><h2 id="Nessie"><a class="docs-heading-anchor" href="#Nessie">Nessie</a><a id="Nessie-1"></a><a class="docs-heading-anchor-permalink" href="#Nessie" title="Permalink"></a></h2><p>The Nessie function estimates the sample size by yearly intervals as well as averages an estimated lifespan left for a given group.  </p><p>This function is highly dependant on the <code>Life</code> function taken from the <code>RateTables.jl</code> package which you can find documented <a href="https://juliasurv.github.io/RateTables.jl/dev/">here</a>.</p><p>The sample size is thus taken by the following formula:</p><p class="math-container">\[ESS(t) = \sum_i^N S_{P_i}(t) * \exp(-\Lambda_{P_i}(t))\]</p><p>While the estimated lifepsan is directly taken from the <code>expectation</code> function. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.nessie" href="#NetSurvival.nessie"><code>NetSurvival.nessie</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">nessie</code></pre><p>To call this function, use the formula below: </p><pre><code class="nohighlight hljs">nessie(@formula(Surv(time,status)~covariate), data, ratetable)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/ba469653a772977d0aabc6184038062d38f9f3e0/src/Nessie.jl#L20-L26">source</a></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation noncanonical"><dl><dt>[1]</dt><dd><div>F. Ederer. <em>The relative survival rate: a statistical methodology</em>. Natl. Cancer Inst. Monogr. <strong>6</strong>, 101–121 (1961).</div></dd><dt>[2]</dt><dd><div>F. Ederer and H. Heise. <em>The effect of eliminating deaths from cancer in general survival rates, methodological notes 11</em>. End Result Evaluation Section, National Cancer Institute (1959).</div></dd><dt>[3]</dt><dd><div>T. Hakulinen. <em>On long-term relative survival rates</em>. Journal of Chronic Diseases <strong>30</strong>, 431–443 (1977).</div></dd><dt>[4]</dt><dd><div>M. P. Perme, J. Stare and J. Estève. <em>On Estimation in Relative Survival</em>. <a href="https://doi.org/10.1111/j.1541-0420.2011.01640.x">Biometrics <strong>68</strong>, 113–120</a> (2011).</div></dd><dt>[5]</dt><dd><div>N. Grafféo, F. Castell, A. Belot and R. Giorgi. <em>A Log-Rank-Type Test to Compare Net Survival Distributions</em>. <a href="https://doi.org/10.1111/biom.12477">Biometrics <strong>72</strong>, 760–769</a> (2016).</div></dd><dt>[6]</dt><dd><div>T. R. Fleming and D. P. Harrington. <em>Counting Processes and Survival Analysis</em>. Vol. 625 (John Wiley &amp; Sons, 2013).</div></dd><dt>[7]</dt><dd><div>P. K. Andersen, O. Borgan, R. D. Gill and N. Keiding. <a href="https://doi.org/10.1007/978-1-4612-4348-9"><em>Statistical Models Based on Counting Processes</em></a>. <em>Springer Series in Statistics</em> (Springer US, New York, NY, 1993).</div></dd><dt>[8]</dt><dd><div>M. P. Perme and K. Pavlic. <em>Nonparametric relative survival analysis with the R package relsurv</em>. Journal of Statistical Software <strong>87</strong>, 1–27 (2018).</div></dd><dt>[9]</dt><dd><div>H. Charvat and A. Belot. <em>Mexhaz: An R package for fitting flexible hazard-based regression models for overall and excess mortality with a random effect</em>. Journal of Statistical Software <strong>98</strong>, 1–36 (2021).</div></dd><dt>[10]</dt><dd><div>K. A. Cronin and E. J. Feuer. <em>Cumulative cause-specific mortality for cancer patients in the presence of other causes: a crude analogue of relative survival</em>. Statistics in medicine <strong>19</strong>, 1729–1740 (2000).</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../example/">Case study »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 17 June 2024 10:35">Monday 17 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
