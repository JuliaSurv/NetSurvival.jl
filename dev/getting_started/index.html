<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting Started · NetSurvival.jl</title><meta name="title" content="Getting Started · NetSurvival.jl"/><meta property="og:title" content="Getting Started · NetSurvival.jl"/><meta property="twitter:title" content="Getting Started · NetSurvival.jl"/><meta name="description" content="Documentation for NetSurvival.jl."/><meta property="og:description" content="Documentation for NetSurvival.jl."/><meta property="twitter:description" content="Documentation for NetSurvival.jl."/><meta property="og:url" content="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><meta property="twitter:url" content="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><link rel="canonical" href="https://JuliaSurv.github.io/NetSurvival.jl/getting_started/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NetSurvival.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li class="is-active"><a class="tocitem" href>Getting Started</a><ul class="internal"><li><a class="tocitem" href="#Fitting-the-non-parametric-estimators"><span>Fitting the non parametric estimators</span></a></li><li><a class="tocitem" href="#Applying-the-Grafféo-log-rank-test"><span>Applying the Grafféo log-rank test</span></a></li></ul></li><li><a class="tocitem" href="../benches/">Benchmarking results</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Getting Started</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting Started</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSurv/NetSurvival.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/main/docs/src/getting_started.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Getting-Started"><a class="docs-heading-anchor" href="#Getting-Started">Getting Started</a><a id="Getting-Started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-Started" title="Permalink"></a></h1><h2 id="Fitting-the-non-parametric-estimators"><a class="docs-heading-anchor" href="#Fitting-the-non-parametric-estimators">Fitting the non parametric estimators</a><a id="Fitting-the-non-parametric-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-the-non-parametric-estimators" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.PoharPerme" href="#NetSurvival.PoharPerme"><code>NetSurvival.PoharPerme</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PoharPerme</code></pre><p>This method estimates net survival probabilities by applying the following estimation:</p><p class="math-container">\[\partial\hat{\Lambda}_E(t) = \frac{\sum_i \frac{dN_i(u)}{S_{P_i}(u)} - \sum_i \frac{Y_i(u)}{S_{P_i}(u)}d\Lambda_{P_i}(u)}{\sum_i \frac{Y_i(u)}{S_{P_i}(u)}}\]</p><p>To fit the Pohar Perme to your data based on a certain rate table, apply the example below to your code : </p><pre><code class="nohighlight hljs">fit(PoharPerme, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre><p>References: </p><ul><li>[<a href="../references/#PoharPerme2012">4</a>] Perme, Maja Pohar and Stare, Janez and Estève, Jacques (2012). On Estimation in Relative Survival.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/54fb501169d9428d91999d0f92303d1d694cd69e/src/PoharPerme.jl#L41-L56">source</a></section></article><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>We will illustrate with an example using the dataset <code>colrec</code>, which comprises <span>$5971$</span> patients diagnosed with colon or rectal cancer  between 1994 and 2000. This dataset is sourced from the Slovenia cancer registry. Given the high probability that the patients are Slovenian, we will be using the Slovenian mortality table <code>slopop</code> as reference for the populational rates. Subsequently, we can apply various non-parametric estimators for net survival analysis.</p><div class="admonition is-info"><header class="admonition-header">N.B.</header><div class="admonition-body"><p>Mortality tables may vary in structure, with options such as the addition or removal of specific covariates. To confirm that the mortality table is in the correct format, please refer to the documentation of <code>RateTables.jl</code>, or directly extract it from there.</p></div></div><p>By examining <code>slopop</code>, we notice it contains information regarding <code>age</code> and <code>year</code>, as expected for mortality tables. Additionally, it incorporates the covariate sex, which has two possible entries (<code>:male</code> or <code>:female</code>).</p><p><strong>Pohar Perme</strong></p><pre><code class="language-julia hljs">using NetSurvival, RateTables
pp1 = fit(PoharPerme, @formula(Surv(time,status)~1), colrec, slopop)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr1">8149×5 DataFrame</span>
<span class="sgr1">  Row </span>│<span class="sgr1"> Sₑ          ∂Λₑ            σₑ             lower_95_CI  upper_95_CI </span>
      │<span class="sgr90"> Float64     Float64        Float64        Float64      Float64     </span>
──────┼────────────────────────────────────────────────────────────────────
    1 │   0.997105    0.00289493     0.000710632    0.995717      0.998495
    2 │   0.995214    0.0018967      0.0009186      0.993424      0.997007
    3 │   0.992149    0.00307987     0.00117581     0.989865      0.994438
    4 │   0.988748    0.00342788     0.0014077      0.986024      0.99148
    5 │   0.986016    0.00276316     0.0015717      0.982983      0.989058
    6 │   0.983283    0.00277109     0.00172089     0.979972      0.986605
    7 │   0.981722    0.00158763     0.0018035      0.978258      0.985199
    8 │   0.976973    0.00483737     0.00202472     0.973104      0.980858
  ⋮   │     ⋮             ⋮              ⋮             ⋮            ⋮
 8143 │   0.390001   -0.00054201     0.740969       0.0912751     1.6664
 8144 │   0.390212   -0.00054201     0.740969       0.0913245     1.6673
 8145 │   0.390424   -0.00054201     0.740969       0.091374      1.66821
 8146 │   0.390636   -0.00054201     0.740969       0.0914235     1.66911
 8147 │   0.390847   -0.00054201     0.740969       0.0914731     1.67002
 8148 │   0.391059   -0.00054201     0.740969       0.0915227     1.67092
 8149 │ NaN         NaN            NaN            NaN           NaN
<span class="sgr36">                                                          8134 rows omitted</span></code></pre><h2 id="Applying-the-Grafféo-log-rank-test"><a class="docs-heading-anchor" href="#Applying-the-Grafféo-log-rank-test">Applying the Grafféo log-rank test</a><a id="Applying-the-Grafféo-log-rank-test-1"></a><a class="docs-heading-anchor-permalink" href="#Applying-the-Grafféo-log-rank-test" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="NetSurvival.GraffeoTest" href="#NetSurvival.GraffeoTest"><code>NetSurvival.GraffeoTest</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GraffeoTest</code></pre><p>The Grafféo test is a log-rank type test and is typically used in net survival analysis to determine the impact of certain covariates in the study.</p><p>The null <span>$(H_0)$</span> hypothesis tests the following assumption:</p><p class="math-container">\[\forall t \in [0,T], \Lambda_{E,g_1}(t) = \Lambda_{E,g_2}(t) = ... = \Lambda_{E,g_k}(t)\]</p><p>where <span>$G = {g_1,...,g_k}$</span> is a partition of <span>$1,...,n$</span> consisting of disjoint groups of individuals that we wish to compare to each other.  For all group <span>$g \in G$</span>, let&#39;s denote the numerator and denominator of the Pohar Perme (partial) excess hazard estimators, restricted to individuals in the group, by: </p><ul><li><span>$\partial N_{E,g}(s) = \sum_{i \in g} \frac{\partial N_i(s)}{S_{P_i}(s)} - \frac{Y_i(s)}{S_{P_i}(s)}\partial\Lambda_{P_i}(s)$</span></li><li><span>$Y_{E,g}(s) = \sum_{i \in g} \frac{Y_i(s)}{S_{P_i}(s)}$</span></li><li><span>$R_{g}(s) = \frac{Y_{E,g}(s)}{\sum_{g\in G} Y_{E,g}(s)}$</span></li></ul><p>Then, define the vector <span>$\mathbf Z = \left(Z_{g_r}: r \in 1,...,k-1 \right)$</span> with entries: </p><p class="math-container">\[Z_g(T) = N_{E,g}(s) - \int_{0}^T Y_{E,g}(s) \partial\hat{\Lambda}_E(s)\]</p><p>The test statistic is then given by:</p><p class="math-container">\[U(T) = \mathbf Z(T)&#39;\hat{\Sigma}_Z^{-1} \mathbf Z(T)\]</p><p>where the entries of the <span>$\hat{\Sigma}_Z$</span> matrix are given by: </p><p class="math-container">\[\sigma_{g,h}(T) = \int_0^T \sum_{\ell \in G} \left(\delta_{g,\ell} - R_g(t) \right)\left(\delta_{h,\ell} - R_h(t)\right) \left(\sum_{i\in\ell} \frac{\partial N_i(s)}{S^2_{P_i}}\right)\]</p><p>Under <span>$H_0$</span>, the statistic <span>$U(T)$</span> is asymptotically <span>$\chi^2(k-1)$</span>-distributed.</p><p>To apply the test to your data based on a certain rate table, apply the example below to your code : </p><pre><code class="nohighlight hljs">fit(GraffeoTest, @formula(Surv(time,status)~covariable1 + covariable2), data, ratetable)</code></pre><p>If you wish to stratify a covariate:</p><pre><code class="nohighlight hljs">fit(GraffeoTest, @formula(Surv(time,status)~covariable1 + Strata(covariable2)), data, ratetable)</code></pre><p>References: </p><ul><li>[<a href="../references/#Graffeo2016">5</a>] Grafféo, Nathalie and Castell, Fabienne and Belot, Aurélien and Giorgi, Roch (2016). A Log-Rank-Type Test to Compare Net Survival Distributions.  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSurv/NetSurvival.jl/blob/54fb501169d9428d91999d0f92303d1d694cd69e/src/GraffeoTest.jl#L1-L49">source</a></section></article><h3 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example</a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h3><p>When applying the test to the same data as before, we get:</p><pre><code class="language-julia hljs">test1 = fit(GraffeoTest, @formula(Surv(time,status)~stage), colrec, slopop)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Grafféo&#39;s log-rank-type-test
<span class="sgr1">1×3 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> test_statistic  degrees_of_freedom  p_value      </span>
     │<span class="sgr90"> Float64         Int64               Float64      </span>
─────┼──────────────────────────────────────────────────
   1 │        658.779                   3  1.81926e-142</code></pre><p>The p-value is well under <span>$0.05$</span>, meaning that the different groups identified by the <code>stage</code> variable have different survival probabilities. Thus, it should be taken into consideration in the study.</p><pre><code class="language-julia hljs">test2 = fit(GraffeoTest, @formula(Surv(time,status)~sex), colrec, slopop)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Grafféo&#39;s log-rank-type-test
<span class="sgr1">1×3 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> test_statistic  degrees_of_freedom  p_value  </span>
     │<span class="sgr90"> Float64         Int64               Float64  </span>
─────┼──────────────────────────────────────────────
   1 │       0.843748                   1  0.358327</code></pre><p>For the <code>sex</code> variable, we notice that the p-value is above <span>$0.05$</span> indicating that there isn&#39;t a difference between male and female patients.</p><pre><code class="language-julia hljs">test4 = fit(GraffeoTest, @formula(Surv(time,status)~stage+Strata(sex)), colrec, slopop)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Grafféo&#39;s log-rank-type-test
<span class="sgr1">1×3 DataFrame</span>
<span class="sgr1"> Row </span>│<span class="sgr1"> test_statistic  degrees_of_freedom  p_value      </span>
     │<span class="sgr90"> Float64         Int64               Float64      </span>
─────┼──────────────────────────────────────────────────
   1 │        678.514                   3  9.56849e-147</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory/">« Theory</a><a class="docs-footer-nextpage" href="../benches/">Benchmarking results »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Wednesday 24 April 2024 15:18">Wednesday 24 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
